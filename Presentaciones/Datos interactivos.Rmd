---
title: "Cocodrilos"
author: "Juan Saúl Baez Torreblanca"
date: "8 de agosto de 2015"
output:
        ioslides_presentation:
                css: ./stylesheets/reporte.css
                logo: ../Imagenes/logo.jpg
                smaller: yes
                widescreen: yes
---

## Crecimiento de LHC

```{r paqueterias, include = F, echo = F}
library(dplyr)
library(xts)
library(dygraphs)
library(reshape2)
library(rCharts)
library(lme4)
library(stargazer)
library(ggplot2)
```

```{r datos, echo = F}
LHC = read.csv("../Datos/Tidy/LHC.csv")
ID = LHC[, 1:5]
LHC = t(LHC[, -(1:5)])
colnames(LHC) = ID$MARCA
LHC = xts(LHC,
          order.by = seq.Date(from = as.Date("2015-01-200"),
                              by = "months", length.out = 6)
          )
```

<div id="graphdiv">
```{r LHC CR, echo = F}
dygraph(data = LHC[, ID$Resguardo == "CR"], width = 400, height = 300,
        main = "Con Resguardo", group = "LHC") %>%
        dyHighlight(highlightSeriesOpts = list(strokeWidth = 3)) %>% 
        dyLegend(labelsSeparateLines = T, labelsDiv = "LHCCR") %>% 
        dyAxis("x", rangePad = 20) %>%
        dyOptions(drawPoints = T, pointSize = 2)
```
</div>

<div id="LHCCR", class="legend">
</div>
        
<div id="graphdiv">
```{r LHC SR, echo = F}
dygraph(data = LHC[, ID$Resguardo == "SR"], width = 400, height = 300,
        main = "Sin Resguardo", group = "LHC") %>%
        dyHighlight(highlightSeriesOpts = list(strokeWidth = 3)) %>% 
        dyLegend(width = 500, labelsDiv = "LHCSR", labelsSeparateLines = T) %>% 
        dyAxis("x", rangePad = 20) %>%
        dyOptions(drawPoints = T, pointSize = 2)
```
</div>

<div id="LHCSR", class="legend">
</div>

## Comparación de los grupos

```{r limpieza_LHC_2, echo = F, include = F}
muertos = apply(LHC, 2, function(x) length(na.omit(x))) == 0
LHC = melt(as.data.frame(LHC))
LHC$Tina = factor(rep(ID[!muertos, "Tina"], each = 6))
LHC$Resguardo = factor(rep(ID[!muertos, "Resguardo"], each = 6))
LHC$Silvestre = factor(rep(ID[!muertos, "Silvestre"], each = 6))
names(LHC)[1:2] = c("Marca", "LHC")
LHC$Marca = factor(LHC$Marca)
LHC$Tiempo = rep(1:6, length(unique(LHC$Marca)))
LHC$TinaGrande = factor(LHC$Tina)
levels(LHC$TinaGrande) = rep(1:4, each = 3)
```

```{r ggplot_LHC, echo = F, fig.align = "center", fig.width = 10}
ggplot(na.omit(LHC), aes(x = factor(Marca), y = LHC)) +
        facet_grid(. ~ TinaGrande + Tina, scales = "free") +
        geom_boxplot(aes(color = factor(Resguardo))) +
        theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
        labs(title = "Longitud Hocico-Cloca") +
        labs(x = "Marca", y = "LHC", color = "Resguardo")
```

## Modelo lineal de efectos mixtos

```{r, echo = F, comment = NA, results="asis"}
model = lmer(LHC ~ Resguardo + (1|TinaGrande/Tina/Marca), data = LHC)
stargazer(model)
# summary(model)
```
